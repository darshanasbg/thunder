openapi: 3.0.3
info:
  title: OrganizationUnit Management API
  version: "1.0"
  description: This API is used to manage organization units.
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html

servers:
  - url: https://{host}:{port}
    variables:
      host:
        default: "localhost"
      port:
        default: "8090"

tags:
  - name: organization-units
    description: Operations related to organization unit management
  - name: organization-units-by-path
    description: Operations related to organization units using hierarchical handle paths
  - name: users
    description: Operations related to user management
  - name: users-by-path
    description: Operations related to user management using hierarchical handle paths
  - name: groups
    description: Operations related to group management
  - name: groups-by-path
    description: Operations related to group management using hierarchical handle paths

paths:
  /organization-units:
    get:
      tags:
        - organization-units
      summary: List root organization units
      parameters:
        - $ref: '#/components/parameters/limitQueryParam'
        - $ref: '#/components/parameters/offsetQueryParam'
      responses:
        "200":
          description: List of root organization units
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationUnitListResponse'
              example:
                totalResults: 5
                startIndex: 1
                count: 2
                organizationUnits:
                  - id: "afc77cfd-620b-4cf0-a31c-7377b0ea8902"
                    name: "Engineering"
                    handle: "engineering"
                    description: "Engineering Unit"
                  - id: "b7c40de6-95cd-4c45-8725-9c7cb5b9cafd"
                    name: "Sales"
                    handle: "sales"
                    description: "Sales Unit"
                links:
                  - href: "organization-units?offset=2&limit=2"
                    rel: "next"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-limit:
                  summary: Invalid limit parameter
                  value:
                    code: "OU-1011"
                    message: "Invalid pagination parameter"
                    description: "The limit parameter must be a positive integer"
                invalid-offset:
                  summary: Invalid offset parameter
                  value:
                    code: "OU-1012"
                    message: "Invalid pagination parameter"
                    description: "The offset parameter must be a non-negative integer"
        "500":
          description: Internal server error

    post:
      tags:
        - organization-units
      summary: Create a new organization unit
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOrganizationUnitRequest'
            examples:
              root-ou:
                summary: Root organization unit
                value:
                  name: "Engineering"
                  handle: "engineering"
                  description: "Engineering Unit"
                  parent: null
              nested-ou:
                summary: Nested organization unit
                value:
                  name: "Frontend Team"
                  handle: "frontend"
                  description: "Handles UI/UX work"
                  parent: "afc77cfd-620b-4cf0-a31c-7377b0ea8902"
      responses:
        "201":
          description: Organization unit created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationUnit'
              examples:
                root-ou:
                  summary: Root organization unit
                  value:
                    id: "afc77cfd-620b-4cf0-a31c-7377b0ea8902"
                    name: "Engineering"
                    handle: "engineering"
                    description: "Engineering Unit"
                    parent: null
                nested-ou:
                  summary: Nested organization unit
                  value:
                    id: "4d4cb83a-9bb8-4fd7-970e-36b65f9c8ea4"
                    name: "Frontend Team"
                    handle: "frontend"
                    description: "Handles UI/UX work"
                    parent: "afc77cfd-620b-4cf0-a31c-7377b0ea8902"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-request:
                  summary: Invalid request format
                  value:
                    code: "OU-1001"
                    message: "Invalid request format"
                    description: "The request body is malformed, contains invalid data, or required fields are missing/empty"
                parent-not-found:
                  summary: Parent organization unit not found
                  value:
                    code: "OU-1005"
                    message: "Parent organization unit not found"
                    description: "Parent organization unit not found"
                circular-dependency:
                  summary: Circular dependency detected
                  value:
                    code: "OU-1007"
                    message: "Circular dependency detected"
                    description: "Setting this parent would create a circular dependency"
        "409":
          description: Organization unit name conflict
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "OU-1004"
                message: "Organization unit name conflict"
                description: "An organization unit with the same name exists under the same parent"
        "500":
          description: Internal server error

  /organization-units/{id}:
    get:
      tags:
        - organization-units
      summary: Get an organization unit by id
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Organization unit details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationUnit'
              example:
                id: "afc77cfd-620b-4cf0-a31c-7377b0ea8902"
                name: "Engineering Team"
                handle: "engineering"
                description: "Engineering unit that handles all engineering tasks"
                parent: null
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "OU-1003"
                message: "Organization unit not found"
                description: "The organization unit with the specified id does not exist"
        "500":
          description: Internal server error

    put:
      tags:
        - organization-units
      summary: Update an organization unit by id
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateOrganizationUnitRequest'
            example:
              name: "Engineering Team"
              handle: "engineering"
              description: "Engineering unit that handles all engineering tasks"
              parent: null
      responses:
        "200":
          description: Organization unit updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationUnit'
              example:
                id: "afc77cfd-620b-4cf0-a31c-7377b0ea8902"
                name: "Engineering Team"
                handle: "engineering"
                description: "Engineering unit that handles all engineering tasks"
                parent: null
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-request:
                  summary: Invalid request format
                  value:
                    code: "OU-1001"
                    message: "Invalid request format"
                    description: "The request body is malformed, contains invalid data, or required fields are missing/empty"
                parent-not-found:
                  summary: Parent organization unit not found
                  value:
                    code: "OU-1005"
                    message: "Parent organization unit not found"
                    description: "Parent organization unit not found"
                circular-dependency:
                  summary: Circular dependency detected
                  value:
                    code: "OU-1007"
                    message: "Circular dependency detected"
                    description: "Setting this parent would create a circular dependency"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "OU-1003"
                message: "Organization unit not found"
                description: "The organization unit with the specified id does not exist"
        "409":
          description: Organization unit name conflict
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "OU-1004"
                message: "Organization unit name conflict"
                description: "An organization unit with the same name exists under the same parent"
        "500":
          description: Internal server error

    delete:
      tags:
        - organization-units
      summary: Delete an organization unit by id
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Organization unit deleted
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                has-children:
                  summary: Organization unit has children
                  value:
                    code: "OU-1006"
                    message: "Organization unit has children"
                    description: "Cannot delete organization unit with children or users or groups"
        "500":
          description: Internal server error

  /organization-units/{id}/ous:
    get:
      tags:
        - organization-units
      summary: List child organization units
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/limitQueryParam'
        - $ref: '#/components/parameters/offsetQueryParam'
      responses:
        "200":
          description: List of child organization units
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationUnitListResponse'
              example:
                totalResults: 5
                startIndex: 1
                count: 2
                organizationUnits:
                  - id: "6b59f277-fd79-40b1-afca-dce75d3709f7"
                    name: "Frontend Team"
                    handle: "frontend"
                    description: "Handles UI/UX work"
                  - id: "2a8f9e1c-4d7b-4c8a-9f3e-1b2c3d4e5f6g"
                    name: "Backend Team"
                    handle: "backend"
                    description: "Handles server-side development"
                links:
                  - href: "organization-units/afc77cfd-620b-4cf0-a31c-7377b0ea8902/ous?offset=2&limit=2"
                    rel: "next"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-limit:
                  summary: Invalid limit parameter
                  value:
                    code: "OU-1011"
                    message: "Invalid pagination parameter"
                    description: "The limit parameter must be a positive integer"
                invalid-offset:
                  summary: Invalid offset parameter
                  value:
                    code: "OU-1012"
                    message: "Invalid pagination parameter"
                    description: "The offset parameter must be a non-negative integer"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "OU-1003"
                message: "Organization unit not found"
                description: "The organization unit with the specified id does not exist"
        "500":
          description: Internal server error

  /organization-units/{id}/users:
    get:
      tags:
        - organization-units
      summary: List users in organization unit
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/limitQueryParam'
        - $ref: '#/components/parameters/offsetQueryParam'
      responses:
        "200":
          description: List of users in the organization unit
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserListResponse'
              example:
                totalResults: 5
                startIndex: 1
                count: 2
                users:
                  - id: "3f9d5c8e-3c56-4f09-a1db-bb3d5e3f4b5d"
                  - id: "9f4bc2ee-8d1e-4e21-a3b4-17d9b612e320"
                links:
                  - href: "organization-units/afc77cfd-620b-4cf0-a31c-7377b0ea8902/users?offset=2&limit=2"
                    rel: "next"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-limit:
                  summary: Invalid limit parameter
                  value:
                    code: "OU-1011"
                    message: "Invalid pagination parameter"
                    description: "The limit parameter must be a positive integer"
                invalid-offset:
                  summary: Invalid offset parameter
                  value:
                    code: "OU-1012"
                    message: "Invalid pagination parameter"
                    description: "The offset parameter must be a non-negative integer"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "OU-1003"
                message: "Organization unit not found"
                description: "The organization unit with the specified id does not exist"
        "500":
          description: Internal server error

  /organization-units/{id}/groups:
    get:
      tags:
        - organization-units
      summary: List groups in organization unit
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/limitQueryParam'
        - $ref: '#/components/parameters/offsetQueryParam'
      responses:
        "200":
          description: List of groups in the organization unit
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupListResponse'
              example:
                totalResults: 5
                startIndex: 1
                count: 2
                groups:
                  - id: "c2a4f62d-7c79-46f2-b2de-8e8cb4f1c456"
                    name: "Developers"
                  - id: "8a8e4fa2-2e55-478d-bf0f-4a2ddaf9ee7d"
                    name: "Architects"
                links:
                  - href: "organization-units/afc77cfd-620b-4cf0-a31c-7377b0ea8902/groups?offset=2&limit=2"
                    rel: "next"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-limit:
                  summary: Invalid limit parameter
                  value:
                    code: "OU-1011"
                    message: "Invalid pagination parameter"
                    description: "The limit parameter must be a positive integer"
                invalid-offset:
                  summary: Invalid offset parameter
                  value:
                    code: "OU-1012"
                    message: "Invalid pagination parameter"
                    description: "The offset parameter must be a non-negative integer"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "OU-1003"
                message: "Organization unit not found"
                description: "The organization unit with the specified id does not exist"
        "500":
          description: Internal server error

  /organization-units/tree/{handlePath}:
    get:
      tags:
        - organization-units-by-path
      summary: Get an organization unit by hierarchical handle path
      parameters:
        - in: path
          name: handlePath
          required: true
          schema:
            type: string
          style: simple
          explode: false
          description: |
            Hierarchical path of organization unit handles separated by forward slashes.
            Examples:
            - `engineering` - Gets the root OU with handle "engineering"
            - `engineering/frontend` - Gets the "frontend" OU under "engineering"
            - `engineering/frontend/ui` - Gets the "ui" OU under "engineering/frontend"
          example: "engineering/frontend"
      responses:
        "200":
          description: Organization unit details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationUnit'
              examples:
                single-level:
                  summary: Single level handle
                  value:
                    id: "afc77cfd-620b-4cf0-a31c-7377b0ea8902"
                    name: "Engineering"
                    handle: "engineering"
                    description: "Engineering unit"
                    parent: null
                multi-level:
                  summary: Multi-level handle path
                  value:
                    id: "6b59f277-fd79-40b1-afca-dce75d3709f7"
                    name: "Frontend Team"
                    handle: "frontend"
                    description: "Handles UI/UX work"
                    parent: "afc77cfd-620b-4cf0-a31c-7377b0ea8902"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                path-not-found:
                  summary: Handle path not found
                  value:
                    code: "OU-1003"
                    message: "Organization unit not found"
                    description: "The organization unit with the specified handle path does not exist"
                invalid-path:
                  summary: Invalid path structure
                  value:
                    code: "OU-1008"
                    message: "Invalid handle path"
                    description: "The handle path does not represent a valid organizational hierarchy"
        "500":
          description: Internal server error

    put:
      tags:
        - organization-units-by-path
      summary: Update an organization unit by hierarchical handle path
      parameters:
        - in: path
          name: handlePath
          required: true
          schema:
            type: string
          style: simple
          explode: false
          description: |
            Hierarchical path of organization unit handles separated by forward slashes.
            Examples:
            - `engineering` - Updates the root OU with handle "engineering"
            - `engineering/frontend` - Updates the "frontend" OU under "engineering"
            - `engineering/frontend/ui` - Updates the "ui" OU under "engineering/frontend"
          example: "engineering/frontend"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateOrganizationUnitByHandleRequest'
            examples:
              single-level:
                summary: Update single level OU
                value:
                  name: "Engineering Division"
                  handle: "engineering"
                  description: "Main engineering division"
              multi-level:
                summary: Update nested OU
                value:
                  name: "Frontend Development"
                  handle: "frontend"
                  description: "Frontend development team with expanded scope"
      responses:
        "200":
          description: Organization unit updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationUnit'
              examples:
                single-level:
                  summary: Updated single level OU
                  value:
                    id: "afc77cfd-620b-4cf0-a31c-7377b0ea8902"
                    name: "Engineering Division"
                    handle: "engineering"
                    description: "Main engineering division"
                    parent: null
                multi-level:
                  summary: Updated nested OU
                  value:
                    id: "6b59f277-fd79-40b1-afca-dce75d3709f7"
                    name: "Frontend Development"
                    handle: "frontend"
                    description: "Frontend development team with expanded scope"
                    parent: "afc77cfd-620b-4cf0-a31c-7377b0ea8902"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-request:
                  summary: Invalid request format
                  value:
                    code: "OU-1001"
                    message: "Invalid request format"
                    description: "The request body is malformed, contains invalid data, or required fields are missing/empty"
                handle-conflict:
                  summary: Handle already exists under parent
                  value:
                    code: "OU-1010"
                    message: "Handle conflict"
                    description: "An organization unit with the same handle already exists under the same parent"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                path-not-found:
                  summary: Handle path not found
                  value:
                    code: "OU-1003"
                    message: "Organization unit not found"
                    description: "The organization unit with the specified handle path does not exist"
                invalid-path:
                  summary: Invalid path structure
                  value:
                    code: "OU-1008"
                    message: "Invalid handle path"
                    description: "The handle path does not represent a valid organizational hierarchy"
        "409":
          description: Organization unit name conflict
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "OU-1004"
                message: "Organization unit name conflict"
                description: "An organization unit with the same name exists under the same parent"
        "500":
          description: Internal server error

    delete:
      tags:
        - organization-units-by-path
      summary: Delete an organization unit by hierarchical handle path
      parameters:
        - in: path
          name: handlePath
          required: true
          schema:
            type: string
          style: simple
          explode: false
          description: |
            Hierarchical path of organization unit handles separated by forward slashes.
            Examples:
            - `engineering` - Deletes the root OU with handle "engineering"
            - `engineering/frontend` - Deletes the "frontend" OU under "engineering"
            - `engineering/frontend/ui` - Deletes the "ui" OU under "engineering/frontend"
          example: "engineering/frontend"
      responses:
        "204":
          description: Organization unit deleted
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                has-children:
                  summary: Organization unit has children
                  value:
                    code: "OU-1006"
                    message: "Organization unit has children"
                    description: "Cannot delete organization unit with children or users or groups"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                path-not-found:
                  summary: Handle path not found
                  value:
                    code: "OU-1003"
                    message: "Organization unit not found"
                    description: "The organization unit with the specified handle path does not exist"
                invalid-path:
                  summary: Invalid path structure
                  value:
                    code: "OU-1008"
                    message: "Invalid handle path"
                    description: "The handle path does not represent a valid organizational hierarchy"
        "500":
          description: Internal server error

  /organization-units/tree/{handlePath}/ous:
    post:
      tags:
        - organization-units-by-path
      summary: Create a new organization unit under the specified handle path
      parameters:
        - in: path
          name: handlePath
          required: true
          schema:
            type: string
          style: simple
          explode: false
          description: |
            Hierarchical path of the parent organization unit handles separated by forward slashes.
            The new OU will be created as a child of the OU specified by this path.
            Examples:
            - `engineering` - Creates a new OU under the "engineering" OU
            - `engineering/frontend` - Creates a new OU under "engineering/frontend"
          example: "engineering/frontend"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOrganizationUnitByHandleRequest'
            examples:
              simple-ou:
                summary: Create OU under single-level path
                value:
                  name: "SRE Team"
                  handle: "sre"
                  description: "Maintains site reliability"
              nested-ou:
                summary: Create OU under multi-level path
                value:
                  name: "UI Team"
                  handle: "ui"
                  description: "Handles user interface development"
      responses:
        "201":
          description: Organization unit created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationUnit'
              examples:
                simple-ou:
                  summary: OU created under single-level path
                  value:
                    name: "SRE Team"
                    handle: "sre"
                    description: "Maintains site reliability"
                    parent: "6b59f277-fd79-40b1-afca-dce75d3709f7"
                nested-ou:
                  summary: OU created under multi-level path
                  value:
                    id: "8c3d2e1f-9a8b-4c5d-7e6f-1a2b3c4d5e6f"
                    name: "UI Team"
                    handle: "ui"
                    description: "Handles user interface development"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-request:
                  summary: Invalid request format
                  value:
                    code: "OU-1001"
                    message: "Invalid request format"
                    description: "The request body is malformed, contains invalid data, or required fields are missing/empty"
                invalid-parent-path:
                  summary: Parent path not found
                  value:
                    code: "OU-1009"
                    message: "Parent handle path not found"
                    description: "The specified parent handle path does not exist"
                handle-conflict:
                  summary: Handle already exists under parent
                  value:
                    code: "OU-1010"
                    message: "Handle conflict"
                    description: "An organization unit with the same handle already exists under the specified parent path"
        "404":
          description: Parent organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "OU-1009"
                message: "Parent handle path not found"
                description: "The specified parent handle path does not exist"
        "500":
          description: Internal server error

    get:
      tags:
        - organization-units-by-path
      summary: List child organization units by handle path
      parameters:
        - in: path
          name: handlePath
          required: true
          schema:
            type: string
          style: simple
          explode: false
          description: |
            Hierarchical path of organization unit handles separated by forward slashes.
            Examples:
            - `engineering` - Lists children of the "engineering" OU
            - `engineering/frontend` - Lists children of "engineering/frontend"
          example: "engineering/frontend"
        - $ref: '#/components/parameters/limitQueryParam'
        - $ref: '#/components/parameters/offsetQueryParam'
      responses:
        "200":
          description: List of child organization units
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationUnitListResponse'
              example:
                totalResults: 5
                startIndex: 1
                count: 2
                organizationUnits:
                  - id: "6b59f277-fd79-40b1-afca-dce75d3709f7"
                    name: "Frontend Team"
                    handle: "frontend"
                    description: "Handles UI/UX work"
                  - id: "2a8f9e1c-4d7b-4c8a-9f3e-1b2c3d4e5f6g"
                    name: "Backend Team"
                    handle: "backend"
                    description: "Handles server-side development"
                links:
                  - href: "organization-units/tree/engineering/ous?offset=2&limit=2"
                    rel: "next"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-limit:
                  summary: Invalid limit parameter
                  value:
                    code: "OU-1011"
                    message: "Invalid pagination parameter"
                    description: "The limit parameter must be a positive integer"
                invalid-offset:
                  summary: Invalid offset parameter
                  value:
                    code: "OU-1012"
                    message: "Invalid pagination parameter"
                    description: "The offset parameter must be a non-negative integer"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                path-not-found:
                  summary: Handle path not found
                  value:
                    code: "OU-1003"
                    message: "Organization unit not found"
                    description: "The organization unit with the specified handle path does not exist"
                invalid-path:
                  summary: Invalid path structure
                  value:
                    code: "OU-1008"
                    message: "Invalid handle path"
                    description: "The handle path does not represent a valid organizational hierarchy"
        "500":
          description: Internal server error

  /organization-units/tree/{handlePath}/users:
    get:
      tags:
        - organization-units-by-path
      summary: List users in organization unit by handle path
      parameters:
        - in: path
          name: handlePath
          required: true
          schema:
            type: string
          style: simple
          explode: false
          description: |
            Hierarchical path of organization unit handles separated by forward slashes.
            Examples:
            - `engineering` - Lists users in the "engineering" OU
            - `engineering/frontend` - Lists users in "engineering/frontend"
          example: "engineering/frontend"
        - $ref: '#/components/parameters/limitQueryParam'
        - $ref: '#/components/parameters/offsetQueryParam'
      responses:
        "200":
          description: List of users in the organization unit
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserListResponse'
              example:
                totalResults: 5
                startIndex: 1
                count: 2
                users:
                  - id: "3f9d5c8e-3c56-4f09-a1db-bb3d5e3f4b5d"
                  - id: "9f4bc2ee-8d1e-4e21-a3b4-17d9b612e320"
                links:
                  - href: "organization-units/tree/engineering/frontend/users?offset=2&limit=2"
                    rel: "next"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-limit:
                  summary: Invalid limit parameter
                  value:
                    code: "OU-1011"
                    message: "Invalid pagination parameter"
                    description: "The limit parameter must be a positive integer"
                invalid-offset:
                  summary: Invalid offset parameter
                  value:
                    code: "OU-1012"
                    message: "Invalid pagination parameter"
                    description: "The offset parameter must be a non-negative integer"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                path-not-found:
                  summary: Handle path not found
                  value:
                    code: "OU-1003"
                    message: "Organization unit not found"
                    description: "The organization unit with the specified handle path does not exist"
                invalid-path:
                  summary: Invalid path structure
                  value:
                    code: "OU-1008"
                    message: "Invalid handle path"
                    description: "The handle path does not represent a valid organizational hierarchy"
        "500":
          description: Internal server error

  /organization-units/tree/{handlePath}/groups:
    get:
      tags:
        - organization-units-by-path
      summary: List groups in organization unit by handle path
      parameters:
        - in: path
          name: handlePath
          required: true
          schema:
            type: string
          style: simple
          explode: false
          description: |
            Hierarchical path of organization unit handles separated by forward slashes.
            Examples:
            - `engineering` - Lists groups in the "engineering" OU
            - `engineering/frontend` - Lists groups in "engineering/frontend"
          example: "engineering/frontend"
        - $ref: '#/components/parameters/limitQueryParam'
        - $ref: '#/components/parameters/offsetQueryParam'
      responses:
        "200":
          description: List of groups in the organization unit
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupListResponse'
              example:
                totalResults: 5
                startIndex: 1
                count: 2
                groups:
                  - id: "c2a4f62d-7c79-46f2-b2de-8e8cb4f1c456"
                    name: "Developers"
                  - id: "8a8e4fa2-2e55-478d-bf0f-4a2ddaf9ee7d"
                    name: "Architects"
                links:
                  - href: "organization-units/tree/engineering/frontend/groups?offset=2&limit=2"
                    rel: "next"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-limit:
                  summary: Invalid limit parameter
                  value:
                    code: "OU-1011"
                    message: "Invalid pagination parameter"
                    description: "The limit parameter must be a positive integer"
                invalid-offset:
                  summary: Invalid offset parameter
                  value:
                    code: "OU-1012"
                    message: "Invalid pagination parameter"
                    description: "The offset parameter must be a non-negative integer"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                path-not-found:
                  summary: Handle path not found
                  value:
                    code: "OU-1003"
                    message: "Organization unit not found"
                    description: "The organization unit with the specified handle path does not exist"
                invalid-path:
                  summary: Invalid path structure
                  value:
                    code: "OU-1008"
                    message: "Invalid handle path"
                    description: "The handle path does not represent a valid organizational hierarchy"
        "500":
          description: Internal server error

  /users:
    get:
      tags:
        - users
      summary: List users
      responses:
        "200":
          description: List of users
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User2'
              example:
                - id: "9a475e1e-b0cb-4b29-8df5-2e5b24fb0ed3"
                  organizationUnit: "456e8400-e29b-41d4-a716-446655440001"
                  type: "customer"
                  attributes:
                    age: 24
                    email: "jane.doe@example.com"
                    mobile: "+1-650-555-1234"
                    address:
                      city: "Mountain View"
                      zip: "94040"
                    contactPreferences:
                      - email
                      - sms
                - id: "039bda67-a80d-4b7b-ac0f-36db85332089"
                  organizationUnit: "456e8400-e29b-41d4-a716-446655440001"
                  type: "customer"
                  attributes:
                    age: 31
                    email: "john.smith@example.com"
                    mobile: "+1-650-903-0002"
                    address:
                      city: "Palo Alto"
                      zip: "94301"
                    contactPreferences:
                      - sms
                - id: "e1b6ba6c-deb2-4d24-87b0-bbf79fa4487c"
                  organizationUnit: "26eec421-f1bb-4deb-a5d3-9ab6554c2ae6"
                  type: "employee"
                  attributes:
                    username: "alice.wu"
                    firstname: "Alice"
                    lastname: "Wu"
                    department: "Engineering"
                    email: "alice.wu@company.inc"
        "500":
          description: Internal server error
    post:
      tags:
        - users
      summary: Create a new user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User2'
            example:
              organizationUnit: "456e8400-e29b-41d4-a716-446655440001"
              type: "customer"
              attributes:
                age: 24
                email: "jane.doe@example.com"
                mobile: "+1-650-555-1234"
                address:
                  city: "Mountain View"
                  zip: "94040"
                contactPreferences:
                  - email
                  - sms
      responses:
        "201":
          description: User created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User2'
              example:
                id: "9a475e1e-b0cb-4b29-8df5-2e5b24fb0ed3"
                organizationUnit: "456e8400-e29b-41d4-a716-446655440001"
                type: "customer"
                attributes:
                  age: 24
                  email: "jane.doe@example.com"
                  mobile: "+1-650-555-1234"
                  address:
                    city: "Mountain View"
                    zip: "94040"
                  contactPreferences:
                    - email
                    - sms
        "400":
          description: Bad request
        "409":
          description: Conflict
        "500":
          description: Internal server error

  /users/{id}:
    get:
      tags:
        - users
      summary: Get a user by id
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          example: "9a475e1e-b0cb-4b29-8df5-2e5b24fb0ed3"
      responses:
        "200":
          description: User details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User2'
              example:
                id: "9a475e1e-b0cb-4b29-8df5-2e5b24fb0ed3"
                organizationUnit: "456e8400-e29b-41d4-a716-446655440001"
                type: "customer"
                attributes:
                  age: 24
                  email: "jane.doe@example.com"
                  mobile: "+1-650-555-1234"
                  address:
                    city: "Mountain View"
                    zip: "94040"
                  contactPreferences:
                    - email
                    - sms
        "404":
          description: User not found
        "500":
          description: Internal server error
    put:
      tags:
        - users
      summary: Update a user by id
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          example: "9a475e1e-b0cb-4b29-8df5-2e5b24fb0ed3"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User2'
      responses:
        "200":
          description: User updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User2'
              example:
                id: "9a475e1e-b0cb-4b29-8df5-2e5b24fb0ed3"
                organizationUnit: "456e8400-e29b-41d4-a716-446655440001"
                type: "customer"
                attributes:
                  age: 25
                  email: "jane.doe@example.com"
                  mobile: "+1-650-555-5678"
                  address:
                    city: "Mountain View"
                    zip: "94040"
                  contactPreferences:
                    - email
        "400":
          description: Bad request
        "404":
          description: User not found
        "500":
          description: Internal server error
    delete:
      tags:
        - users
      summary: Delete a user by id
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          example: "9a475e1e-b0cb-4b29-8df5-2e5b24fb0ed3"
      responses:
        "204":
          description: User deleted
        "404":
          description: User not found
        "500":
          description: Internal server error

  /users/tree/{handlePath}:
    get:
      tags:
        - users-by-path
      summary: List users in organization unit specified by handle path
      parameters:
        - in: path
          name: handlePath
          required: true
          schema:
            type: string
          style: simple
          explode: false
          description: |
            Hierarchical path of organization unit handles separated by forward slashes.
            Examples:
            - `engineering` - Lists users in the "engineering" OU
            - `engineering/frontend` - Lists users in "engineering/frontend"
          example: "engineering/frontend"
        - $ref: '#/components/parameters/limitQueryParam'
        - $ref: '#/components/parameters/offsetQueryParam'
      responses:
        "200":
          description: List of users in the organization unit
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserListResponse'
              example:
                totalResults: 5
                startIndex: 1
                count: 2
                users:
                  - id: "7a4b1f8e-5c69-4b60-9232-2b0aaf65ef3c"
                  - id: "9f1e47d3-0347-4464-9f02-e0bfae02e896"
                links:
                  - href: "users/tree/engineering/frontend?offset=10&limit=10"
                    rel: "next"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-limit:
                  summary: Invalid limit parameter
                  value:
                    code: "OU-1011"
                    message: "Invalid pagination parameter"
                    description: "The limit parameter must be a positive integer"
                invalid-offset:
                  summary: Invalid offset parameter
                  value:
                    code: "OU-1012"
                    message: "Invalid pagination parameter"
                    description: "The offset parameter must be a non-negative integer"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                path-not-found:
                  summary: Handle path not found
                  value:
                    code: "OU-1003"
                    message: "Organization unit not found"
                    description: "The organization unit with the specified handle path does not exist"
                invalid-path:
                  summary: Invalid path structure
                  value:
                    code: "OU-1008"
                    message: "Invalid handle path"
                    description: "The handle path does not represent a valid organizational hierarchy"
        "500":
          description: Internal server error
          content:
            text/plain:
              schema:
                type: string
              example: "Internal server error"

    post:
      tags:
        - users-by-path
      summary: Create a new user under the organization unit specified by the handle path
      parameters:
        - in: path
          name: handlePath
          required: true
          schema:
            type: string
          style: simple
          explode: false
          description: |
            Hierarchical path of organization unit handles separated by forward slashes.
            The new user will be created under the organization unit specified by this path.
            Examples:
            - `engineering` - Creates a new user under the "engineering" OU
            - `engineering/frontend` - Creates a new user under "engineering/frontend"
          example: "engineering/frontend"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUserByPathRequest'
            example:
              organizationUnit: "a839f4bd-39dc-4eaa-b5cc-210d8ecaee87"
              type: "employee"
              attributes:
                username: "john.doe"
                firstname: "John"
                lastname: "Doe"
                email: "john.doe@company.com"
                department: "Engineering"
      responses:
        "201":
          description: User created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User2'
              example:
                id: "7a4b1f8e-5c69-4b60-9232-2b0aaf65ef3c"
                organizationUnit: "a839f4bd-39dc-4eaa-b5cc-210d8ecaee87"
                type: "employee"
                attributes:
                  username: "john.doe"
                  firstname: "John"
                  lastname: "Doe"
                  email: "john.doe@company.com"
                  department: "Engineering"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-request-format:
                  summary: Invalid request format
                  value:
                    code: "OU-1001"
                    message: "Invalid request format"
                    description: "The request body is malformed, contains invalid data, or required fields are missing/empty"
                username-conflict:
                  summary: Username already exists
                  value:
                    code: "OU-1014"
                    message: "Username conflict"
                    description: "A user with the same username already exists"
                email-conflict:
                  summary: Email already exists
                  value:
                    code: "OU-1015"
                    message: "Email conflict"
                    description: "A user with the same email already exists"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                path-not-found:
                  summary: Handle path not found
                  value:
                    code: "OU-1003"
                    message: "Organization unit not found"
                    description: "The organization unit with the specified handle path does not exist"
                invalid-path:
                  summary: Invalid path structure
                  value:
                    code: "OU-1008"
                    message: "Invalid handle path"
                    description: "The handle path does not represent a valid organizational hierarchy"
        "409":
          description: Conflict
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                username-conflict:
                  summary: Username already exists
                  value:
                    code: "OU-1014"
                    message: "Username conflict"
                    description: "A user with the same username already exists"
                email-conflict:
                  summary: Email already exists
                  value:
                    code: "OU-1015"
                    message: "Email conflict"
                    description: "A user with the same email already exists"
        "500":
          description: Internal server error
          content:
            text/plain:
              schema:
                type: string
              example: "Internal server error"

  /groups:
    get:
      tags:
        - groups
      summary: List groups
      parameters:
        - $ref: '#/components/parameters/limitQueryParam'
        - $ref: '#/components/parameters/offsetQueryParam'
      responses:
        "200":
          description: List of groups
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupListResponse2'
              example:
                totalResults: 5
                startIndex: 1
                count: 2
                groups:
                  - id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                    name: "Sports"
                    description: "Sports group"
                    organizationUnitId: "a839f4bd-39dc-4eaa-b5cc-210d8ecaee87"
                  - id: "257e528f-eb24-48b6-884d-20460e190957"
                    name: "Managers"
                    description: "Manager group"
                    organizationUnitId: "a839f4bd-39dc-4eaa-b5cc-210d8ecaee87"
                links:
                  - href: "groups?offset=2&limit=2"
                    rel: "next"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-request-format:
                  summary: Invalid request format
                  value:
                    code: "GRP-1001"
                    message: "Invalid request format"
                    description: "The request body is malformed or contains invalid data"
                invalid-limit:
                  summary: Invalid limit parameter
                  value:
                    code: "GRP-1001"
                    message: "Invalid request format"
                    description: "Invalid limit parameter value"
                invalid-offset:
                  summary: Invalid offset parameter
                  value:
                    code: "GRP-1001"
                    message: "Invalid request format"
                    description: "Invalid offset parameter value"
        "500":
          description: Internal server error
          content:
            text/plain:
              schema:
                type: string
              example: "Internal server error"

    post:
      tags:
        - groups
      summary: Create a new group
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGroupRequest'
            example:
              name: "Sports"
              description: "Sports group"
              organizationUnitId: "a839f4bd-39dc-4eaa-b5cc-210d8ecaee87"
              members:
                - type: "user"
                  id: "7a4b1f8e-5c69-4b60-9232-2b0aaf65ef3c"
                - type: "user"
                  id: "9f1e47d3-0347-4464-9f02-e0bfae02e896"
                - type: "group"
                  id: "6b1e7b8d-7e19-41eb-8fa2-c0ee5bb67a94"
      responses:
        "201":
          description: Group created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Group2'
              example:
                id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                name: "Sports"
                description: "Sports group"
                organizationUnitId: "a839f4bd-39dc-4eaa-b5cc-210d8ecaee87"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-request-format:
                  summary: Invalid request format
                  value:
                    code: "GRP-1001"
                    message: "Invalid request format"
                    description: "The request body is malformed or contains invalid data"
                invalid-user-id:
                  summary: Invalid member ID
                  value:
                    code: "GRP-1007"
                    message: "Invalid member ID"
                    description: "One or more member IDs in the request do not exist"
                ou-not-found:
                  summary: Organization unit not found
                  value:
                    code: "GRP-1005"
                    message: "Organization unit not found"
                    description: "Organization unit not found"
        "409":
          description: Conflict
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "GRP-1004"
                message: "Group name conflict"
                description: "A group with the same name exists under the same organization unit"
        "500":
          description: Internal server error
          content:
            text/plain:
              schema:
                type: string
              example: "Internal server error"

  /groups/{id}:
    get:
      tags:
        - groups
      summary: Get a group by id
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Group details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Group2'
              example:
                id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                name: "Sports"
                description: "Sports group"
                organizationUnitId: "a839f4bd-39dc-4eaa-b5cc-210d8ecaee87"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "GRP-1002"
                message: "Invalid request format"
                description: "Group ID is required"
        "404":
          description: Group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "GRP-1003"
                message: "Group not found"
                description: "The group with the specified id does not exist"
        "500":
          description: Internal server error
          content:
            text/plain:
              schema:
                type: string
              example: "Internal server error"

    put:
      tags:
        - groups
      summary: Update a group by id
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateGroupRequest'
            example:
              name: "Activities"
              description: "Activities group"
              organizationUnitId: "a839f4bd-39dc-4eaa-b5cc-210d8ecaee87"
              members:
                - type: "user"
                  id: "7a4b1f8e-5c69-4b60-9232-2b0aaf65ef3c"
                - type: "user"
                  id: "9f1e47d3-0347-4464-9f02-e0bfae02e896"
                - type: "group"
                  id: "6b1e7b8d-7e19-41eb-8fa2-c0ee5bb67a94"
      responses:
        "200":
          description: Group updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Group2'
              example:
                id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                name: "Activities"
                description: "Activities group"
                organizationUnitId: "a839f4bd-39dc-4eaa-b5cc-210d8ecaee87"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                missing-group-id:
                  summary: Missing group ID
                  value:
                    code: "GRP-1002"
                    message: "Invalid request format"
                    description: "Group ID is required"
                invalid-request-format:
                  summary: Invalid request format
                  value:
                    code: "GRP-1001"
                    message: "Invalid request format"
                    description: "The request body is malformed or contains invalid data"
                invalid-user-id:
                  summary: Invalid member ID
                  value:
                    code: "GRP-1007"
                    message: "Invalid member ID"
                    description: "One or more member IDs in the request do not exist"
                ou-not-found:
                  summary: Organization unit not found
                  value:
                    code: "GRP-1005"
                    message: "Organization unit not found"
                    description: "Organization unit not found"
        "404":
          description: Group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "GRP-1003"
                message: "Group not found"
                description: "The group with the specified id does not exist"
        "409":
          description: Conflict
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "GRP-1004"
                message: "Group name conflict"
                description: "A group with the same name exists under the same organization unit"
        "500":
          description: Internal server error
          content:
            text/plain:
              schema:
                type: string
              example: "Internal server error"

    delete:
      tags:
        - groups
      summary: Delete a group by id
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Group deleted
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                missing-group-id:
                  summary: Missing group ID
                  value:
                    code: "GRP-1002"
                    message: "Invalid request format"
                    description: "Group ID is required"
                cannot-delete-group:
                  summary: Cannot delete group
                  value:
                    code: "GRP-1006"
                    message: "Cannot delete group"
                    description: "Cannot delete group with child groups"
        "500":
          description: Internal server error
          content:
            text/plain:
              schema:
                type: string
              example: "Internal server error"

  /groups/{id}/members:
    get:
      tags:
        - groups
      summary: List members in group
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/limitQueryParam'
        - $ref: '#/components/parameters/offsetQueryParam'
      responses:
        "200":
          description: List of members in the group
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MemberListResponse'
              example:
                totalResults: 5
                startIndex: 1
                count: 2
                members:
                  - type: "user"
                    id: "7a4b1f8e-5c69-4b60-9232-2b0aaf65ef3c"
                  - type: "group"
                    id: "8c2f8e9e-8f2a-4f5b-9c3d-4e5f6a7b8c9d"
                links:
                  - href: "groups/3fa85f64-5717-4562-b3fc-2c963f66afa6/members?offset=2&limit=2"
                    rel: "next"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-limit:
                  summary: Invalid limit parameter
                  value:
                    code: "GRP-1001"
                    message: "Invalid request format"
                    description: "Invalid limit parameter value"
                invalid-offset:
                  summary: Invalid offset parameter
                  value:
                    code: "GRP-1001"
                    message: "Invalid request format"
                    description: "Invalid offset parameter value"
        "404":
          description: Group not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "GRP-1003"
                message: "Group not found"
                description: "The group with the specified id does not exist"
        "500":
          description: Internal server error
          content:
            text/plain:
              schema:
                type: string
              example: "Internal server error"

  /groups/tree/{handlePath}:
    get:
      tags:
        - groups-by-path
      summary: List groups in organization unit specified by handle path
      parameters:
        - in: path
          name: handlePath
          required: true
          schema:
            type: string
          style: simple
          explode: false
          description: |
            Hierarchical path of organization unit handles separated by forward slashes.
            Examples:
            - `engineering` - Lists groups in the "engineering" OU
            - `engineering/frontend` - Lists groups in "engineering/frontend"
          example: "engineering/frontend"
        - $ref: '#/components/parameters/limitQueryParam'
        - $ref: '#/components/parameters/offsetQueryParam'
      responses:
        "200":
          description: List of groups in the organization unit
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GroupListResponse2'
              example:
                totalResults: 5
                startIndex: 1
                count: 2
                groups:
                  - id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                    name: "Sports"
                    description: "Sports group"
                    organizationUnitId: "a839f4bd-39dc-4eaa-b5cc-210d8ecaee87"
                  - id: "257e528f-eb24-48b6-884d-20460e190957"
                    name: "Managers"
                    description: "Manager group"
                    organizationUnitId: "a839f4bd-39dc-4eaa-b5cc-210d8ecaee87"
                links:
                  - href: "groups/tree/engineering/frontend?offset=2&limit=2"
                    rel: "next"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-limit:
                  summary: Invalid limit parameter
                  value:
                    code: "GRP-1001"
                    message: "Invalid request format"
                    description: "Invalid limit parameter value"
                invalid-offset:
                  summary: Invalid offset parameter
                  value:
                    code: "GRP-1001"
                    message: "Invalid request format"
                    description: "Invalid offset parameter value"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                path-not-found:
                  summary: Handle path not found
                  value:
                    code: "OU-1003"
                    message: "Organization unit not found"
                    description: "The organization unit with the specified handle path does not exist"
                invalid-path:
                  summary: Invalid path structure
                  value:
                    code: "OU-1008"
                    message: "Invalid handle path"
                    description: "The handle path does not represent a valid organizational hierarchy"
        "500":
          description: Internal server error
          content:
            text/plain:
              schema:
                type: string
              example: "Internal server error"

    post:
      tags:
        - groups-by-path
      summary: Create a new group under the organization unit specified by the handle path
      parameters:
        - in: path
          name: handlePath
          required: true
          schema:
            type: string
          style: simple
          explode: false
          description: |
            Hierarchical path of organization unit handles separated by forward slashes.
            The new group will be created under the organization unit specified by this path.
            Examples:
            - `engineering` - Creates a new group under the "engineering" OU
            - `engineering/frontend` - Creates a new group under "engineering/frontend"
          example: "engineering/frontend"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGroupByPathRequest'
            example:
              name: "Sports"
              description: "Sports group"
              members:
                - type: "user"
                  id: "7a4b1f8e-5c69-4b60-9232-2b0aaf65ef3c"
                - type: "user"
                  id: "9f1e47d3-0347-4464-9f02-e0bfae02e896"
                - type: "group"
                  id: "6b1e7b8d-7e19-41eb-8fa2-c0ee5bb67a94"
      responses:
        "201":
          description: Group created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Group2'
              example:
                id: "3fa85f64-5717-4562-b3fc-2c963f66afa6"
                name: "Sports"
                description: "Sports group"
                organizationUnitId: "a839f4bd-39dc-4eaa-b5cc-210d8ecaee87"
        "400":
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid-request-format:
                  summary: Invalid request format
                  value:
                    code: "GRP-1001"
                    message: "Invalid request format"
                    description: "The request body is malformed or contains invalid data"
                invalid-member-id:
                  summary: Invalid member ID
                  value:
                    code: "GRP-1007"
                    message: "Invalid member ID"
                    description: "One or more member IDs in the request do not exist"
                parent-path-not-found:
                  summary: Organization unit path not found
                  value:
                    code: "OU-1009"
                    message: "Organization unit handle path not found"
                    description: "The specified organization unit handle path does not exist"
        "404":
          description: Organization unit not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                path-not-found:
                  summary: Handle path not found
                  value:
                    code: "OU-1003"
                    message: "Organization unit not found"
                    description: "The organization unit with the specified handle path does not exist"
                invalid-path:
                  summary: Invalid path structure
                  value:
                    code: "OU-1008"
                    message: "Invalid handle path"
                    description: "The handle path does not represent a valid organizational hierarchy"
        "409":
          description: Conflict
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              example:
                code: "GRP-1004"
                message: "Group name conflict"
                description: "A group with the same name exists under the same organization unit"
        "500":
          description: Internal server error
          content:
            text/plain:
              schema:
                type: string
              example: "Internal server error"

components:
  parameters:
    limitQueryParam:
      in: query
      name: limit
      required: false
      description: |
        Maximum number of records to return.
      schema:
        type: integer
        minimum: 1
        default: 30
    offsetQueryParam:
      in: query
      name: offset
      required: false
      description: |
        Number of records to skip for pagination.
      schema:
        type: integer
        default: 0

  schemas:
    OrganizationUnitBasic:
      type: object
      required: [id, name, handle]
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        handle:
          type: string
        description:
          type: string

    OrganizationUnit:
      allOf:
        - $ref: '#/components/schemas/OrganizationUnitBasic'
      properties:
        parent:
          type: string
          format: uuid
          nullable: true

    User:
      type: object
      required: [id]
      properties:
        id:
          type: string
          format: uuid

    Group:
      type: object
      required: [id, name]
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string

    Link:
      type: object
      properties:
        href:
          type: string
          example: "organization-units?offset=20&limit=10"
        rel:
          type: string
          example: "next"

    CreateOrganizationUnitByHandleRequest:
      type: object
      required: [name, handle]
      properties:
        name:
          type: string
          description: "The display name of the organization unit"
          example: "Frontend Development Team"
        handle:
          type: string
          description: "The unique handle for the organization unit within its parent"
          example: "frontend-dev"
        description:
          type: string
          description: "Optional description of the organization unit"
          example: "Team responsible for frontend development and UI/UX"

    UpdateOrganizationUnitByHandleRequest:
      type: object
      required: [name, handle]
      properties:
        name:
          type: string
          description: "The display name of the organization unit"
          example: "Frontend Development Team"
        handle:
          type: string
          description: "The unique handle for the organization unit within its parent"
          example: "frontend-dev"
        description:
          type: string
          description: "Optional description of the organization unit"
          example: "Team responsible for frontend development and UI/UX"

    CreateOrganizationUnitRequest:
      allOf:
        - $ref: '#/components/schemas/CreateOrganizationUnitByHandleRequest'
      required: [name, handle, parent]
      properties:
        parent:
          type: string
          format: uuid
          nullable: true

    UpdateOrganizationUnitRequest:
      allOf:
        - $ref: '#/components/schemas/CreateOrganizationUnitRequest'

    OrganizationUnitListResponse:
      type: object
      properties:
        totalResults:
          type: integer
          description: "Number of results that match the listing operation."
          example: 15
        startIndex:
          type: integer
          description: "Index of the first element of the page, which will be equal to offset + 1."
          example: 1
        count:
          type: integer
          description: "Number of elements in the returned page."
          example: 10
        organizationUnits:
          type: array
          items:
            $ref: '#/components/schemas/OrganizationUnitBasic'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'

    UserListResponse:
      type: object
      properties:
        totalResults:
          type: integer
          description: "Number of results that match the listing operation."
          example: 25
        startIndex:
          type: integer
          description: "Index of the first element of the page, which will be equal to offset + 1."
          example: 1
        count:
          type: integer
          description: "Number of elements in the returned page."
          example: 10
        users:
          type: array
          items:
            $ref: '#/components/schemas/User'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'

    GroupListResponse:
      type: object
      properties:
        totalResults:
          type: integer
          description: "Number of results that match the listing operation."
          example: 8
        startIndex:
          type: integer
          description: "Index of the first element of the page, which will be equal to offset + 1."
          example: 1
        count:
          type: integer
          description: "Number of elements in the returned page."
          example: 5
        groups:
          type: array
          items:
            $ref: '#/components/schemas/Group'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'

    Error:
      type: object
      required: [code, message]
      properties:
        code:
          type: string
        message:
          type: string
        description:
          type: string


    Member:
      type: object
      required: [id, type]
      properties:
        id:
          type: string
          format: uuid
        type:
          type: string
          enum:
            - user
            - group

    Group2:
      type: object
      required: [id, name, organizationUnitId]
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
          nullable: true
        organizationUnitId:
          type: string
          format: uuid
        members:
          type: array
          items:
            $ref: '#/components/schemas/Member'

    CreateGroupRequest:
      type: object
      required: [name, organizationUnitId]
      properties:
        name:
          type: string
        description:
          type: string
        organizationUnitId:
          type: string
          format: uuid
        members:
          type: array
          items:
            $ref: '#/components/schemas/Member'

    CreateGroupByPathRequest:
      type: object
      required: [name]
      properties:
        name:
          type: string
          description: "The display name of the group"
          example: "Sports Team"
        description:
          type: string
          description: "Optional description of the group"
          example: "Group for sports activities and events"
        members:
          type: array
          description: "Optional list of initial members (users and groups)"
          items:
            $ref: '#/components/schemas/Member'

    UpdateGroupRequest:
      allOf:
        - $ref: '#/components/schemas/CreateGroupRequest'

    GroupListResponse2:
      type: object
      properties:
        totalResults:
          type: integer
          description: "Number of results that match the listing operation."
          example: 8
        startIndex:
          type: integer
          description: "Index of the first element of the page, which will be equal to offset + 1."
          example: 1
        count:
          type: integer
          description: "Number of elements in the returned page."
          example: 5
        groups:
          type: array
          items:
            $ref: '#/components/schemas/Group2'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'

    MemberListResponse:
      type: object
      properties:
        totalResults:
          type: integer
          description: "Number of results that match the listing operation."
          example: 20
        startIndex:
          type: integer
          description: "Index of the first element of the page, which will be equal to offset + 1."
          example: 1
        count:
          type: integer
          description: "Number of elements in the returned page."
          example: 10
        members:
          type: array
          items:
            $ref: '#/components/schemas/Member'
        links:
          type: array
          items:
            $ref: '#/components/schemas/Link'

    User2:
      type: object
      properties:
        id:
          type: string
        organizationUnit:
          type: string
        type:
          type: string
        attributes:
          type: object
          additionalProperties: true

    CreateUserByPathRequest:
      type: object
      required: [type]
      properties:
        type:
          type: string
          description: "The type of user"
          example: "employee"
        attributes:
          type: object
          description: "User attributes"
          additionalProperties: true
          example:
            username: "john.doe"
            firstname: "John"
            lastname: "Doe"
            email: "john.doe@company.com"
            department: "Engineering"
